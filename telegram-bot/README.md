# Telegram Bot –¥–ª—è HackTaika

Telegram –±–æ—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–∫–∞—Ö —Å —Å–∞–π—Ç–∞ HackTaika.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü§ñ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ `/start`
- üåê –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–∞–π—Ç —á–µ—Ä–µ–∑ Mini App
- üì¨ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞—è–≤–∫–∞—Ö (Order)
- üìã –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∑–∞—è–≤–∫–∞—Ö (DetailedApplication)
- üîí –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ webhook endpoints —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```bash
cp .env.example .env
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather
TELEGRAM_ADMIN_ID=your_telegram_user_id
WEBAPP_URL=https://yourdomain.com
BOT_WEBHOOK_SECRET=your_secret_key
```

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/botfather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ `.env`

### –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@userinfobot](https://t.me/userinfobot)
2. –ù–∞–∂–º–∏—Ç–µ `/start`
3. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç –≤–∞–º –≤–∞—à ID
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –≤ `.env` –∫–∞–∫ `TELEGRAM_ADMIN_ID`

## –ó–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å–∫ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
chmod +x start.sh
./start.sh
```

### –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –±–æ—Ç–∞ (–¥–ª—è –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

```bash
python bot.py
```

### –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ webhook —Å–µ—Ä–≤–µ—Ä–∞ (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)

```bash
python webhook_server.py
```

## Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t hacktaika-telegram-bot .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  --name telegram-bot \
  --env-file .env \
  -p 3001:3001 \
  hacktaika-telegram-bot
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Next.js

–í Next.js API —Ä–æ—É—Ç–∞—Ö –¥–æ–±–∞–≤—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É webhook –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏:

```typescript
// –ü—Ä–∏–º–µ—Ä –¥–ª—è /api/orders/route.ts
const notifyTelegram = async (orderData: any) => {
  try {
    await fetch(process.env.BOT_WEBHOOK_URL + '/webhook/order', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Webhook-Secret': process.env.BOT_WEBHOOK_SECRET || '',
      },
      body: JSON.stringify(orderData),
    });
  } catch (error) {
    console.error('Error notifying telegram:', error);
  }
};

// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
await notifyTelegram({
  name: order.name,
  email: order.email,
  phone: order.phone,
  telegram: order.telegram,
  message: order.message,
  createdAt: order.createdAt.toISOString(),
});
```

## API Endpoints

### POST /webhook/order
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ—Å—Ç–æ–π –∑–∞—è–≤–∫–µ

**Headers:**
- `X-Webhook-Secret`: —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `Content-Type`: application/json

**Body:**
```json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@example.com",
  "phone": "+7 999 123-45-67",
  "telegram": "@username",
  "message": "–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å —Å–∞–π—Ç",
  "createdAt": "2025-10-05T12:00:00Z"
}
```

### POST /webhook/application
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∑–∞—è–≤–∫–µ

**Headers:**
- `X-Webhook-Secret`: —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `Content-Type`: application/json

**Body:**
```json
{
  "fullName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@example.com",
  "phone": "+7 999 123-45-67",
  "telegram": "@username",
  "projectType": "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω",
  "projectProblem": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã",
  "targetAudience": "–ú–æ–ª–æ–¥—ã–µ —Ä–æ–¥–∏—Ç–µ–ª–∏",
  "budget": "150 000 - 300 000 ‚ÇΩ",
  "deadline": "1-2 –º–µ—Å—è—Ü–∞",
  "description": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞",
  "additionalInfo": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
  "createdAt": "2025-10-05T12:00:00Z"
}
```

### GET /health
Health check endpoint

**Response:**
```json
{
  "status": "ok",
  "service": "telegram-bot-webhook"
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-bot/
‚îú‚îÄ‚îÄ bot.py                  # –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç (–∫–æ–º–∞–Ω–¥—ã, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
‚îú‚îÄ‚îÄ webhook_server.py       # Webhook —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile             # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ start.sh               # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç BotFather | –î–∞ |
| `TELEGRAM_ADMIN_ID` | ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | –î–∞ |
| `WEBAPP_URL` | URL —Å–∞–π—Ç–∞ HackTaika | –î–∞ |
| `BOT_WEBHOOK_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è webhook | –î–∞ |
| `WEBHOOK_PORT` | –ü–æ—Ä—Ç –¥–ª—è webhook —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3001) | –ù–µ—Ç |

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ stdout. –í Docker –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑:

```bash
docker logs -f telegram-bot
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ webhook –∑–∞–ø—Ä–æ—Å—ã –∑–∞—â–∏—â–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º (`X-Webhook-Secret`)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS –¥–ª—è webhook endpoints
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª

## Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `bot.py` –∑–∞–ø—É—â–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `webhook_server.py` –∑–∞–ø—É—â–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TELEGRAM_ADMIN_ID` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤ –±–æ—Ç–µ –∏ Next.js
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Next.js –º–æ–∂–µ—Ç –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –¥–æ webhook —Å–µ—Ä–≤–µ—Ä–∞

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ Docker
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 3001 –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–æ–º
